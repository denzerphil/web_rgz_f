<!-- currency.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Курс валют | ПАО «Транснефть»</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto+Slab:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="content-wrapper">
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <img src="img/Транснефть.png" height="80px">
                </div>
                <div class="logo-text">ТРАНС<span>НЕФТЬ</span></div>
            </div>
            
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link"><i class="fas fa-building"></i> О компании</a></li>
                <li><a href="news.html" class="nav-link"><i class="fas fa-newspaper"></i> Новости</a></li>
                <li><a href="currency.html" class="nav-link active"><i class="fas fa-chart-line"></i> Курс валют</a></li>
                <li><a href="contacts.html" class="nav-link"><i class="fas fa-address-book"></i> Контакты</a></li>
                <li><a href="video.html" class="nav-link"><i class="fas fa-play-circle"></i> Видео</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-container">
                <section id="currency" class="page active">
                    <h1>Курс валют</h1>
                    
                    <div class="currency-container">
                        <div class="calculator">
                            <h2>Калькулятор валют</h2>
                            
                            <div class="input-group">
                                <label for="amount">Сумма:</label>
                                <input type="number" id="amount" placeholder="Введите сумму" min="0" step="0.01">
                            </div>
                            
                            <div class="input-group">
                                <label for="fromCurrency">Из:</label>
                                <select id="fromCurrency">
                                    <option value="RUB">Российский рубль (RUB)</option>
                                    <option value="USD">Доллар США (USD)</option>
                                    <option value="EUR">Евро (EUR)</option>
                                    <option value="CNY">Китайский юань (CNY)</option>
                                    <option value="RSD">Сербский динар (RSD)</option>
                                </select>
                            </div>
                            
                            <div class="input-group">
                                <label for="toCurrency">В:</label>
                                <select id="toCurrency">
                                    <option value="USD">Доллар США (USD)</option>
                                    <option value="EUR">Евро (EUR)</option>
                                    <option value="CNY">Китайский юань (CNY)</option>
                                    <option value="RSD">Сербский динар (RSD)</option>
                                    <option value="RUB" selected>Российский рубль (RUB)</option>
                                </select>
                            </div>
                            
                            <button class="btn-convert" onclick="convertCurrency()"><i class="fas fa-exchange-alt"></i> Рассчитать</button>
                            
                            <div class="result" id="result">
                                Результат конвертации отобразится здесь
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <h2>Динамика курса сербского динара (RSD)</h2>
                            <p>Изменение курса за последние 30 дней:</p>
                            <div class="chart-wrapper">
                                <canvas id="currencyChart"></canvas>
                            </div>
                            <div class="chart-info" id="chartInfo">
                                Курс на <span id="chartDate">01.06.2023</span>: 
                                <b><span id="chartRate">3.45</span> RSD/RUB</b>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <footer class="footer">
        <div class="footer-container">
            <div>
                <div class="footer-logo">
                    <img src="img/Транснефть.png" height="40px">
                    ТРАНС<span>НЕФТЬ</span>
                </div>
                <p class="footer-text">Крупнейшая в мире нефтетранспортная компания, обеспечивающая транспортировку более 80% добываемой в России нефти.</p>
                <div class="social-links">
                    <a href="https://vk.com/selskayaliganso" class="social-link"><i class="fab fa-vk"></i></a>
                    <a href="https://vk.com/selskayaliganso" class="social-link"><i class="fab fa-telegram"></i></a>
                    <a href="https://vk.com/selskayaliganso" class="social-link"><i class="fab fa-youtube"></i></a>
                    <a href="https://vk.com/selskayaliganso" class="social-link"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
            
            <div>
                <h3 class="footer-title">Навигация</h3>
                <ul class="footer-links">
                    <li><a href="index.html"><i class="fas fa-chevron-right"></i> О компании</a></li>
                    <li><a href="news.html"><i class="fas fa-chevron-right"></i> Новости</a></li>
                    <li><a href="currency.html"><i class="fas fa-chevron-right"></i> Курс валют</a></li>
                    <li><a href="contacts.html"><i class="fas fa-chevron-right"></i> Контакты</a></li>
                    <li><a href="video.html"><i class="fas fa-chevron-right"></i> Видео</a></li>
                </ul>
            </div>
            
            <div>
                <h3 class="footer-title">Ресурсы</h3>
                <ul class="footer-links">
                    <li><a href="https://www.transneft.ru/investors/" target="_blank"><i class="fas fa-chevron-right"></i> Инвесторам</a></li>
                    <li><a href="https://www.transneft.ru/" target="_blank"><i class="fas fa-chevron-right"></i> Пресс-центр</a></li>
                    <li><a href="https://www.transneft.ru/" target="_blank"><i class="fas fa-chevron-right"></i> Закупки</a></li>
                    <li><a href="https://www.transneft.ru/career/" target="_blank"><i class="fas fa-chevron-right"></i> Карьера</a></li>
                    <li><a href="https://www.transneft.ru/" target="_blank"><i class="fas fa-chevron-right"></i> Экология</a></li>
                </ul>
            </div>
            
            <div>
                <h3 class="footer-title">Контакты</h3>
                <ul class="footer-links">
                    <li><a href="contacts.html"><i class="fas fa-map-marker-alt"></i>123112, г. Москва, Пресненская набережная, д. 4, стр. 2, башня «Эволюция»</a></li>
                    <li><a href="tel:+74951112233"><i class="fas fa-phone"></i> +7 (495) 950-81-78</a></li>
                    <li><a href="mailto:info@transneft.ru"><i class="fas fa-envelope"></i> transneft@transneft.ru</a></li>
                    <li><a href="contacts.html"><i class="fas fa-clock"></i> Пн-Чт: 9:00-18:00, Пт: 9:00-16:45</a></li>
                </ul>
            </div>
        </div>
        
        <div class="copyright">
            © 2025 ПАО «Транснефть». Все права защищены.
        </div>
    </footer>
    
    <a href="#" class="btn-top">
        <i class="fas fa-arrow-up"></i>
    </a>

    <script>
        async function fetchCurrencyRates() {
            try {
                const response = await fetch('https://www.cbr-xml-daily.ru/daily_json.js');
                const data = await response.json();
                
                const rates = {
                    'USD': data.Valute.USD.Value,
                    'EUR': data.Valute.EUR.Value,
                    'CNY': data.Valute.CNY.Value,
                    'RSD': data.Valute.RSD.Value,
                    'RUB': 1
                };
                
                return rates;
            } catch (error) {
                console.error('Ошибка при получении курсов валют:', error);
                return {
                    'USD': 90.50,
                    'EUR': 98.75,
                    'CNY': 12.45,
                    'RSD': 0.85,
                    'RUB': 1
                };
            }
        }
        
        async function convertCurrency() {
            const amount = parseFloat(document.getElementById('amount').value);
            const fromCurrency = document.getElementById('fromCurrency').value;
            const toCurrency = document.getElementById('toCurrency').value;
            
            if (isNaN(amount)) {
                document.getElementById('result').innerHTML = 'Пожалуйста, введите корректную сумму';
                return;
            }
            
            const rates = await fetchCurrencyRates();
            
            let result;
            if (fromCurrency === 'RUB') {
                result = amount / rates[toCurrency];
            } else if (toCurrency === 'RUB') {
                result = amount * rates[fromCurrency];
            } else {
                const rubAmount = amount * rates[fromCurrency];
                result = rubAmount / rates[toCurrency];
            }
            
            document.getElementById('result').innerHTML = `
                ${amount.toFixed(2)} ${fromCurrency} = 
                <b>${result.toFixed(2)} ${toCurrency}</b>
            `;
        }
        
        document.addEventListener('DOMContentLoaded', async function() {
            const ctx = document.getElementById('currencyChart').getContext('2d');
            
            const rates = await fetchCurrencyRates();
            const currentRate = rates.RSD;
            
            const dates = [];
            const ratesData = [];
            
            const today = new Date();
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - i);
                
                const day = date.getDate().toString().padStart(2, '0');
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                dates.push(`${day}.${month}`);
                
                const fluctuation = (Math.random() * 0.1) - 0.05;
                const rate = currentRate * (1 + fluctuation);
                ratesData.push(parseFloat(rate.toFixed(4)));
            }
            
            const chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Курс RSD/RUB',
                        data: ratesData,
                        backgroundColor: 'rgba(0, 84, 166, 0.7)',
                        borderColor: 'rgba(0, 84, 166, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Курс (RSD/RUB)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Дата',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45,
                                font: {
                                    size: 10
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 51, 102, 0.9)',
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 10,
                            displayColors: false
                        }
                    },
                    onClick: (e, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            document.getElementById('chartDate').textContent = dates[index];
                            document.getElementById('chartRate').textContent = ratesData[index].toFixed(4);
                            document.getElementById('chartInfo').style.display = 'block';
                            
                            chart.data.datasets[0].backgroundColor = ratesData.map((rate, i) => 
                                i === index ? 'rgba(245, 130, 32, 0.9)' : 'rgba(0, 84, 166, 0.7)'
                            );
                            chart.update();
                        }
                    }
                }
            });
        });
        
        const btnTop = document.querySelector('.btn-top');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                btnTop.style.display = 'flex';
            } else {
                btnTop.style.display = 'none';
            }
        });
        
        btnTop.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>